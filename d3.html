<!-- inspired by d3-graph-gallery.com -->
<!DOCTYPE html>
<meta charset="utf-8">
<script src="https://d3js.org/d3.v6.js"></script>
<div id="count_per_month"></div>

<script>

    var margin = {top: 10, right: 30, bottom: 30, left: 60},
        width = 460 - margin.left - margin.right,
        height = 400 - margin.top - margin.bottom;

    const svg = d3.select("#count_per_month")
        .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform", `translate(${margin.left}, ${margin.top})`);

    d3.csv("https://raw.githubusercontent.com/jvermeir/chart/main/dates.csv").then(function (rawData) {
        const countPerMonth = rawData.reduce((acc, value) => {
            const parts = value.date.split("/");
            const key = parts[1] + "/" + parts[2];
            if (!acc[key]) {
                acc[key] = 1;
            } else {
                acc[key]++;
            }
            return acc;
        }, {});

        const data = Object.keys(countPerMonth).map(x => {
            const parts = x.split("/");
            const year = "20" + parts[1];
            const month = parts[0];
            const count = countPerMonth[x];
            return {year, month, count};
        });

        const x = d3.scaleLinear()
            .domain(["2004", "2021"])
            .range([0, width]);
        svg.append("g")
            .attr("transform", `translate(0, ${height})`)
            .call(d3.axisBottom(x));

        const y = d3.scaleLinear()
            .domain([0, 12])
            .range([height, 0]);
        svg.append("g")
            .call(d3.axisLeft(y));

        svg.append('g')
            .selectAll("dot")
            .data(data)
            .join("circle")
            .attr("cx", function (d) {return x(d.year);})
            .attr("cy", function (d) {return y(d.month);})
            .attr("r", function (d) {return 5 * d.count;})
            .style("fill", "#7220ad")
    })

</script>
